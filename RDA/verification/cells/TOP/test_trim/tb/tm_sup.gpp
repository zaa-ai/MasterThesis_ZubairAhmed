
**------------------------------------------------
** TM
**------------------------------------------------

define TM_ISUP_IDLE
  
  `TM_DSI_OFF_sub
  
enddefine

**----------

define TM_ISUP_RX
  
  `TM_DSI_RXMODE_sub
  
enddefine

**----------

define TM_ISUP_TX
  
  `TM_DSI_TXMODE_sub
  
enddefine

**----------

define TM_SUP_VCCUV
  
  `comment(TM TM_SUP_VCCUV)
  
    `set_bitfield(name=TMR_OUT_CSB_SCK_EN_SCK  val=1)
    `set_bitfield(name=TMR_OUT_CSB_SCK_SEL_SCK val=15)
  `jtag_write_testreg(name=TMR_OUT_CSB_SCK block=TOP)
  
enddefine

**----------

define TM_SUP_VCCUV_reset
  
  `comment(TM TM_SUP_VCCUV_reset)
  
    `set_bitfield(name=TMR_OUT_CSB_SCK_EN_SCK  val=0)
    `set_bitfield(name=TMR_OUT_CSB_SCK_SEL_SCK val=0)
  `jtag_write_testreg(name=TMR_OUT_CSB_SCK block=TOP)
  
enddefine

**----------

define TM_SUP_CLDOUV
  
  `comment(TM TM_SUP_CLDOUV)
  
    `set_bitfield(name=TMR_OUT_CSB_SCK_EN_SCK  val=1)
    `set_bitfield(name=TMR_OUT_CSB_SCK_SEL_SCK val=16)
  `jtag_write_testreg(name=TMR_OUT_CSB_SCK block=TOP)
  
  `jtag_write_register(name=SUP_CTRL block=SUPPLY data=0)
  `wait(t=100`u)
  
enddefine

**----------

define TM_SUP_CLDOUV_reset
  
  `comment(TM TM_SUP_CLDOUV_reset)
  
    `set_bitfield(name=TMR_OUT_CSB_SCK_SEL_SCK val=0)
    `set_bitfield(name=TMR_OUT_CSB_SCK_EN_SCK  val=0)
  `jtag_write_testreg(name=TMR_OUT_CSB_SCK block=TOP)
  
  `jtag_write_register(name=SUP_CTRL block=SUPPLY data=1)
  `wait(t=3`m)
  
enddefine

**----------

define TM_OT_WARN
  
  `comment(TM TM_OT_WARN)
  
    `set_bitfield(name=TMR_OUT_CSB_SCK_EN_SCK  val=1)
    `set_bitfield(name=TMR_OUT_CSB_SCK_SEL_SCK val=13)
  `jtag_write_testreg(name=TMR_OUT_CSB_SCK block=TOP)
  
enddefine

**----------

define TM_OT_ERR
  
  `comment(TM TM_OT_ERR)
  
    `set_bitfield(name=TMR_OUT_CSB_SCK_EN_SCK  val=1)
    `set_bitfield(name=TMR_OUT_CSB_SCK_SEL_SCK val=14)
  `jtag_write_testreg(name=TMR_OUT_CSB_SCK block=TOP)
  
enddefine

**----------

define TM_OT_reset
  
  `comment(TM TM_OT_reset)
  
    `set_bitfield(name=TMR_OUT_CSB_SCK_EN_SCK  val=0)
    `set_bitfield(name=TMR_OUT_CSB_SCK_SEL_SCK val=0)
  `jtag_write_testreg(name=TMR_OUT_CSB_SCK block=TOP)
  
enddefine

**----------
  
define TM_IPS_ON_sub
  
    `set_bitfield(name=OTP_CONTROL_VPPEN   val=1)
    `set_bitfield(name=OTP_CONTROL_VRREN   val=1)
    `set_bitfield(name=OTP_CONTROL_EN_AUTO val=0)
  `jtag_write_testreg(name=OTP_CONTROL block=OTP)
  
    `set_bitfield(name=OTP_BIST_CONTROL_SEL_MRR val=1)
  `jtag_write_testreg(name=OTP_BIST_CONTROL block=OTP)
  
    `set_bitfield(name=OTP_CONFIG_OTP_MRR val=4096)
  `jtag_write_testreg(name=OTP_CONFIG block=OTP)
  
enddefine

**----------
  
define TM_IPS_ON
  
  `comment(TM TM_IPS_ON)
  
  `TM_IPS_ON_sub
  
enddefine

**----------

define TM_IPS_VRR_OVUV
  
  `comment(TM TM_IPS_VRR_OVUV)
  
  `TM_IPS_ON_sub
  
    `set_bitfield(name=TMR_OUT_CSB_SCK_EN_SCK  val=1)
    `set_bitfield(name=TMR_OUT_CSB_SCK_SEL_SCK val=17)
  `jtag_write_testreg(name=TMR_OUT_CSB_SCK block=TOP)
  
enddefine

**----------

define TM_IPS_reset
  
  `comment(TM TM_IPS_VRR_OVUV_reset)
  
    `set_bitfield(name=OTP_CONTROL_VPPEN   val=0)
    `set_bitfield(name=OTP_CONTROL_VRREN   val=0)
    `set_bitfield(name=OTP_CONTROL_EN_AUTO val=1)
  `jtag_write_testreg(name=OTP_CONTROL block=OTP)
  
    `set_bitfield(name=TMR_OUT_CSB_SCK_EN_SCK  val=0)
    `set_bitfield(name=TMR_OUT_CSB_SCK_SEL_SCK val=0)
  `jtag_write_testreg(name=TMR_OUT_CSB_SCK block=TOP)
  
enddefine

**------------------------------------------------
** Trimming
**------------------------------------------------

define TRIM_IREF(__trim__=0)
  
  `comment(TM TRIM_IREF __trim__)
  
  `jtag_write_register(name=TRIM_IREF block=SUPPLY data=__trim__)
  
enddefine

**----------

define TRIM_CLDO(__trim__=0)
  
  `comment(TM TRIM_CLDO __trim__)
  
  `jtag_write_register(name=CLDO_TRIM block=SUPPLY data=__trim__)
  `wait(t=3`m)
  
enddefine

**----------

define TRIM_OT(__trim__=0)
  
  `comment(TM TRIM_OT __trim__)
  
  `jtag_write_register(name=TRIM_OT block=SUPPLY data=__trim__)
  
enddefine

**----------

define TRIM_IPS(__trim_vrr__=0 __trim_vpp__=0)
  
  `comment(TM TRIM_IPS __trim_vrr__ __trim_vpp__)
  
    `set_bitfield(name=OTP_CONFIG_OTP_MRR  val=__trim_vrr__)
    `set_bitfield(name=OTP_CONFIG_OTP_MPP  val=1)
  `jtag_write_testreg(name=OTP_CONFIG block=OTP_CTRL)
  
enddefine

**------------------------------------------------
** ATB
**------------------------------------------------

define ATB_SUP_VBG
  
  `comment(TM ATB_SUP_VBG)
  
    `set_bitfield(name=TMR_ANA_SUPPLY_VBG_2_ATB val=1)
  `jtag_write_testreg(name=TMR_ANA_SUPPLY block=SUP)
  
enddefine

**----------

define ATB_SUP_I10U
  
  `comment(TM ATB_SUP_I10U)
  
    `set_bitfield(name=TMR_ANA_SUPPLY_IBP10U_2_ATB val=1)
  `jtag_write_testreg(name=TMR_ANA_SUPPLY block=SUP)
  
enddefine

**----------

define ATB_SUP_I5U
  
  `comment(TM ATB_SUP_I5U)
  
    `set_bitfield(name=TMR_ANA_SUPPLY_IC5U_2_ATB val=1)
  `jtag_write_testreg(name=TMR_ANA_SUPPLY block=SUP)
  
enddefine

**----------

define ATB_OT_VTEMP
  
  `comment(TM ATB_OT_VTEMP)
  
    `set_bitfield(name=TMR_ANA_TEMP_SENSOR_TS_2_ATB val=1)
  `jtag_write_testreg(name=TMR_ANA_TEMP_SENSOR block=SUP)
  
enddefine

**----------

define ATB_OT_COMP
  
  `comment(TM ATB_OT_COMP)
  
    `set_bitfield(name=TMR_ANA_TEMP_SENSOR_DISCONNECT_TS val=1)
    `set_bitfield(name=TMR_ANA_TEMP_SENSOR_TS_2_ATB      val=1)
  `jtag_write_testreg(name=TMR_ANA_TEMP_SENSOR block=SUP)
  
enddefine

**----------

define ATB_IPS_VPP(__load__=0)
  
  `comment(TM ATB_IPS_VPP __load__)
  
    `set_bitfield(name=TMR_ANA_OTP_OTP_VPP_LOAD val=__load__)
    `set_bitfield(name=TMR_ANA_OTP_OTP_VPP      val=1)
  `jtag_write_testreg(name=TMR_ANA_OTP block=SUP)
  
enddefine

**----------

define ATB_IPS_VRR(__load__=0)
  
  `comment(TM ATB_IPS_VRR __load__)
  
    `set_bitfield(name=TMR_ANA_OTP_OTP_VRR_LOAD val=__load__)
    `set_bitfield(name=TMR_ANA_OTP_OTP_VRR      val=1)
  `jtag_write_testreg(name=TMR_ANA_OTP block=SUP)
  
enddefine

**----------

define ATB_IPS_VRR_FORCE
  
  `comment(TM ATB_IPS_VRR_FORCE)
  
    `set_bitfield(name=TMR_ANA_SUPPLY_VRR_2_ATB val=1)
  `jtag_write_testreg(name=TMR_ANA_SUPPLY block=SUP)
  
enddefine

**----------

define ATB_IPS_VREF
  
  `comment(TM ATB_IPS_VREF)
  
    `set_bitfield(name=TMR_ANA_OTP_OTP_VREF val=1)
  `jtag_write_testreg(name=TMR_ANA_OTP block=SUP)
  
enddefine

**----------

define ATB_IPS_VBG
  
  `comment(TM ATB_IPS_VBG)
  
    `set_bitfield(name=TMR_ANA_OTP_OTP_VBG  val=1)
  `jtag_write_testreg(name=TMR_ANA_OTP block=SUP)
  
enddefine

**------------------------------------------------
**------------------------------------------------
