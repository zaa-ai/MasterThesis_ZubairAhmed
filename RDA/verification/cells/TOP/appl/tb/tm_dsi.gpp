
**------------------------------------------------
** Subs
**------------------------------------------------
  
define TM_DSI_TXMODE_sub

    `set_bitfield(name=TMR_SEL_DSI3_RX_ON     val=1)
    `set_bitfield(name=TMR_SEL_DSI3_HVCASC_ON val=1)
    `set_bitfield(name=TMR_SEL_DSI3_TX_ON     val=1)
    `set_bitfield(name=TMR_SEL_DSI3_RX_TXN    val=1)
    `set_bitfield(name=TMR_SEL_DSI3_TX        val=0)
  `jtag_write_testreg(name=TMR_SEL_DSI3 block=DSI[0])
  `jtag_write_testreg(name=TMR_SEL_DSI3 block=DSI[1])

    `set_bitfield(name=TMR_VAL_DSI3_RX_ON     val=1)
    `set_bitfield(name=TMR_VAL_DSI3_HVCASC_ON val=1)
    `set_bitfield(name=TMR_VAL_DSI3_TX_ON     val=1)
    `set_bitfield(name=TMR_VAL_DSI3_RX_TXN    val=0)
  `jtag_write_testreg(name=TMR_VAL_DSI3 block=DSI[0])
  `jtag_write_testreg(name=TMR_VAL_DSI3 block=DSI[1])
  
enddefine

**----------
  
define TM_DSI_RXMODE_sub

    `set_bitfield(name=TMR_SEL_DSI3_RX_ON     val=1)
    `set_bitfield(name=TMR_SEL_DSI3_HVCASC_ON val=1)
    `set_bitfield(name=TMR_SEL_DSI3_TX_ON     val=1)
    `set_bitfield(name=TMR_SEL_DSI3_RX_TXN    val=1)
    `set_bitfield(name=TMR_SEL_DSI3_TX        val=0)
  `jtag_write_testreg(name=TMR_SEL_DSI3 block=DSI[0])
  `jtag_write_testreg(name=TMR_SEL_DSI3 block=DSI[1])

    `set_bitfield(name=TMR_VAL_DSI3_RX_ON     val=1)
    `set_bitfield(name=TMR_VAL_DSI3_HVCASC_ON val=1)
    `set_bitfield(name=TMR_VAL_DSI3_TX_ON     val=1)
    `set_bitfield(name=TMR_VAL_DSI3_RX_TXN    val=1)
  `jtag_write_testreg(name=TMR_VAL_DSI3 block=DSI[0])
  `jtag_write_testreg(name=TMR_VAL_DSI3 block=DSI[1])

enddefine

**----------
  
define TM_DSI_HZMODE_sub

    `set_bitfield(name=TMR_SEL_DSI3_RX_ON     val=1)
    `set_bitfield(name=TMR_SEL_DSI3_HVCASC_ON val=1)
    `set_bitfield(name=TMR_SEL_DSI3_TX_ON     val=1)
    `set_bitfield(name=TMR_SEL_DSI3_RX_TXN    val=1)
    `set_bitfield(name=TMR_SEL_DSI3_TX        val=0)
  `jtag_write_testreg(name=TMR_SEL_DSI3 block=DSI[0])
  `jtag_write_testreg(name=TMR_SEL_DSI3 block=DSI[1])

    `set_bitfield(name=TMR_VAL_DSI3_RX_ON     val=1)
    `set_bitfield(name=TMR_VAL_DSI3_HVCASC_ON val=1)
    `set_bitfield(name=TMR_VAL_DSI3_TX_ON     val=0)
    `set_bitfield(name=TMR_VAL_DSI3_RX_TXN    val=0)
  `jtag_write_testreg(name=TMR_VAL_DSI3 block=DSI[0])
  `jtag_write_testreg(name=TMR_VAL_DSI3 block=DSI[1])

enddefine

**----------
  
define TM_DSI_OFF_sub

    `set_bitfield(name=TMR_SEL_DSI3_RX_ON     val=1)
    `set_bitfield(name=TMR_SEL_DSI3_HVCASC_ON val=1)
    `set_bitfield(name=TMR_SEL_DSI3_TX_ON     val=1)
    `set_bitfield(name=TMR_SEL_DSI3_RX_TXN    val=1)
    `set_bitfield(name=TMR_SEL_DSI3_TX        val=0)
  `jtag_write_testreg(name=TMR_SEL_DSI3 block=DSI[0])
  `jtag_write_testreg(name=TMR_SEL_DSI3 block=DSI[1])

    `set_bitfield(name=TMR_VAL_DSI3_RX_ON     val=0)
    `set_bitfield(name=TMR_VAL_DSI3_HVCASC_ON val=0)
    `set_bitfield(name=TMR_VAL_DSI3_TX_ON     val=0)
    `set_bitfield(name=TMR_VAL_DSI3_RX_TXN    val=0)
  `jtag_write_testreg(name=TMR_VAL_DSI3 block=DSI[0])
  `jtag_write_testreg(name=TMR_VAL_DSI3 block=DSI[1])

enddefine

**------------------------------------------------
** TM
**------------------------------------------------

define TM_DSI_TX_PIN
  
  `comment(TM TM_DSI_TX_PIN)

  `TM_DSI_TXMODE_sub
  
  *jtag_write_register(name=SUP_CTRL block=SUPPLY data=0)
  
    `set_bitfield(name=TMR_IN_DSI3_tmr_in_tx val=1)
  `jtag_write_testreg(name=TMR_IN_DSI3 block=DSI[0])
  `jtag_write_testreg(name=TMR_IN_DSI3 block=DSI[1])
  
    `set_bitfield(name=TMR_IN_tmr_in_0 val=3)
  `jtag_write_testreg(name=TMR_IN block=TOP)
  
    `set_bitfield(name=TMR_DIG_USE_JTAG val=0)
  `jtag_write_testreg(name=TMR_DIG block=TOP)
  
enddefine

**----------

define TM_DSI_RX1
  
  `comment(TM TM_DSI_RX1)

  `TM_DSI_RXMODE_sub
  
  *jtag_write_register(name=SUP_CTRL block=SUPPLY data=0)
  
    `set_bitfield(name=TMR_OUT_CSB_SCK_EN_SCK  val=1)
    `set_bitfield(name=TMR_OUT_CSB_SCK_SEL_SCK val=33)
  `jtag_write_testreg(name=TMR_OUT_CSB_SCK block=TOP)
  
    `set_bitfield(name=TMR_OUT_MOSI_MISO_EN_MISO  val=1)
    `set_bitfield(name=TMR_OUT_MOSI_MISO_SEL_MISO val=37)
  `jtag_write_testreg(name=TMR_OUT_MOSI_MISO block=TOP)
  
    `set_bitfield(name=TMR_OUT_BFWB_SYNCB_EN_SYNCB  val=1)
    `set_bitfield(name=TMR_OUT_BFWB_SYNCB_SEL_SYNCB val=41)
  `jtag_write_testreg(name=TMR_OUT_BFWB_SYNCB block=TOP)
  
    `set_bitfield(name=TMR_OUT_DAB_INTB_EN_INTB  val=1)
    `set_bitfield(name=TMR_OUT_DAB_INTB_SEL_INTB val=45)
  `jtag_write_testreg(name=TMR_OUT_DAB_INTB block=TOP)
  
    `set_bitfield(name=TMR_DIG_USE_JTAG val=0)
  `jtag_write_testreg(name=TMR_DIG block=TOP)
  
enddefine

**----------

define TM_DSI_RX2
  
  `comment(TM TM_DSI_RX2)

  `TM_DSI_RXMODE_sub
  
  *jtag_write_register(name=SUP_CTRL block=SUPPLY data=0)
  
    `set_bitfield(name=TMR_OUT_CSB_SCK_EN_SCK  val=1)
    `set_bitfield(name=TMR_OUT_CSB_SCK_SEL_SCK val=34)
  `jtag_write_testreg(name=TMR_OUT_CSB_SCK block=TOP)
  
    `set_bitfield(name=TMR_OUT_MOSI_MISO_EN_MISO  val=1)
    `set_bitfield(name=TMR_OUT_MOSI_MISO_SEL_MISO val=38)
  `jtag_write_testreg(name=TMR_OUT_MOSI_MISO block=TOP)
  
    `set_bitfield(name=TMR_OUT_BFWB_SYNCB_EN_SYNCB  val=1)
    `set_bitfield(name=TMR_OUT_BFWB_SYNCB_SEL_SYNCB val=42)
  `jtag_write_testreg(name=TMR_OUT_BFWB_SYNCB block=TOP)
  
    `set_bitfield(name=TMR_OUT_DAB_INTB_EN_INTB  val=1)
    `set_bitfield(name=TMR_OUT_DAB_INTB_SEL_INTB val=46)
  `jtag_write_testreg(name=TMR_OUT_DAB_INTB block=TOP)
  
    `set_bitfield(name=TMR_DIG_USE_JTAG val=0)
  `jtag_write_testreg(name=TMR_DIG block=TOP)
  
enddefine

**----------

define TM_DSI_UV
  
  `comment(TM TM_DSI_UV)

  `TM_DSI_HZMODE_sub
  
    `set_bitfield(name=TMR_OUT_CSB_SCK_EN_SCK  val=1)
    `set_bitfield(name=TMR_OUT_CSB_SCK_SEL_SCK val=35)
  `jtag_write_testreg(name=TMR_OUT_CSB_SCK block=TOP)
  
    `set_bitfield(name=TMR_OUT_MOSI_MISO_EN_MISO  val=1)
    `set_bitfield(name=TMR_OUT_MOSI_MISO_SEL_MISO val=39)
  `jtag_write_testreg(name=TMR_OUT_MOSI_MISO block=TOP)
  
    `set_bitfield(name=TMR_OUT_BFWB_SYNCB_EN_SYNCB  val=1)
    `set_bitfield(name=TMR_OUT_BFWB_SYNCB_SEL_SYNCB val=43)
  `jtag_write_testreg(name=TMR_OUT_BFWB_SYNCB block=TOP)
  
    `set_bitfield(name=TMR_OUT_DAB_INTB_EN_INTB  val=1)
    `set_bitfield(name=TMR_OUT_DAB_INTB_SEL_INTB val=47)
  `jtag_write_testreg(name=TMR_OUT_DAB_INTB block=TOP)
  
    `set_bitfield(name=TMR_DIG_USE_JTAG val=0)
  `jtag_write_testreg(name=TMR_DIG block=TOP)
  
enddefine

**----------

define TM_DSI_OV
  
  `comment(TM TM_DSI_OV)

  `TM_DSI_HZMODE_sub
  
    `set_bitfield(name=TMR_OUT_CSB_SCK_EN_SCK  val=1)
    `set_bitfield(name=TMR_OUT_CSB_SCK_SEL_SCK val=36)
  `jtag_write_testreg(name=TMR_OUT_CSB_SCK block=TOP)
  
    `set_bitfield(name=TMR_OUT_MOSI_MISO_EN_MISO  val=1)
    `set_bitfield(name=TMR_OUT_MOSI_MISO_SEL_MISO val=40)
  `jtag_write_testreg(name=TMR_OUT_MOSI_MISO block=TOP)
  
    `set_bitfield(name=TMR_OUT_BFWB_SYNCB_EN_SYNCB  val=1)
    `set_bitfield(name=TMR_OUT_BFWB_SYNCB_SEL_SYNCB val=44)
  `jtag_write_testreg(name=TMR_OUT_BFWB_SYNCB block=TOP)
  
    `set_bitfield(name=TMR_OUT_DAB_INTB_EN_INTB  val=1)
    `set_bitfield(name=TMR_OUT_DAB_INTB_SEL_INTB val=48)
  `jtag_write_testreg(name=TMR_OUT_DAB_INTB block=TOP)
  
    `set_bitfield(name=TMR_DIG_USE_JTAG val=0)
  `jtag_write_testreg(name=TMR_DIG block=TOP)
  
enddefine

**----------

define TM_DSI_reset
  
  `comment(TM TM_DSI_reset)
  
    `set_bitfield(name=TMR_DIG_USE_JTAG val=1)
  `jtag_write_testreg(name=TMR_DIG block=TOP comment=Disable appl pin functionality [open drain])
  
    `set_bitfield(name=TMR_OUT_CSB_SCK_EN_SCK  val=0)
    `set_bitfield(name=TMR_OUT_CSB_SCK_SEL_SCK val=0)
  `jtag_write_testreg(name=TMR_OUT_CSB_SCK block=TOP)
  
    `set_bitfield(name=TMR_OUT_MOSI_MISO_EN_MISO  val=0)
    `set_bitfield(name=TMR_OUT_MOSI_MISO_SEL_MISO val=0)
  `jtag_write_testreg(name=TMR_OUT_MOSI_MISO block=TOP)
  
    `set_bitfield(name=TMR_OUT_BFWB_SYNCB_EN_SYNCB  val=0)
    `set_bitfield(name=TMR_OUT_BFWB_SYNCB_SEL_SYNCB val=0)
  `jtag_write_testreg(name=TMR_OUT_BFWB_SYNCB block=TOP)
  
    `set_bitfield(name=TMR_OUT_DAB_INTB_EN_INTB  val=0)
    `set_bitfield(name=TMR_OUT_DAB_INTB_SEL_INTB val=0)
  `jtag_write_testreg(name=TMR_OUT_DAB_INTB block=TOP)
  
    `set_bitfield(name=TMR_IN_tmr_in_0 val=0)
  `jtag_write_testreg(name=TMR_IN block=TOP)
  
    `set_bitfield(name=TMR_IN_DSI3_tmr_in_tx val=0)
  `jtag_write_testreg(name=TMR_IN_DSI3 block=DSI[0])
  `jtag_write_testreg(name=TMR_IN_DSI3 block=DSI[1])
  
    `set_bitfield(name=TMR_SEL_WS_DAC val=0)
  `jtag_write_testreg(name=TMR_SEL_WS block=WS[0])
  `jtag_write_testreg(name=TMR_SEL_WS block=WS[1])
  
    `set_bitfield(name=TMR_VAL_WS_DAC val=0)
  `jtag_write_testreg(name=TMR_VAL_WS block=WS[0])
  `jtag_write_testreg(name=TMR_VAL_WS block=WS[1])
  
enddefine

**------------------------------------------------
** Trimming
**------------------------------------------------

define TRIM_DSI_REC_RISE(__sel__ __trim_rx1__=0 __trim_rx2__=0)
  
  `comment(TM TRIM_DSI_REC_RISE __sel__ __trim_rx1__ __trim_rx2__)
  
  `jtag_write_register(name=TRIM_DSI_REC_RISE block=DSI_TRIMMING___sel__ data=16*__trim_rx2__+__trim_rx1__)
  
enddefine

**----------

define TRIM_DSI_REC_FALL(__sel__ __trim_rx1__=0 __trim_rx2__=0)
  
  `comment(TM TRIM_DSI_REC_FALL __sel__ __trim_rx1__ __trim_rx2__)
  
  `jtag_write_register(name=TRIM_DSI_REC_FALL block=DSI_TRIMMING___sel__ data=16*__trim_rx2__+__trim_rx1__)
  
enddefine

**----------

define TRIM_DSI_TX_DAC(__dac__=0)
  
  `comment(TM TRIM_DSI_TX_DAC __dac__)
    `set_bitfield(name=TMR_SEL_WS_DAC val=31)
  `jtag_write_testreg(name=TMR_SEL_WS block=WS[0])
  `jtag_write_testreg(name=TMR_SEL_WS block=WS[1])
  
    `set_bitfield(name=TMR_VAL_WS_DAC val=__dac__)
  `jtag_write_testreg(name=TMR_VAL_WS block=WS[0])
  `jtag_write_testreg(name=TMR_VAL_WS block=WS[1])

enddefine

**----------

define TRIM_DSI_IDAC(__dac__=0)
  
  `comment(TM TRIM_DSI_IDAC __dac__ )
  
  `jtag_write_register(name=DSI_LOAD block=DSI_1 data=__dac__)
  `jtag_write_register(name=DSI_LOAD block=DSI_0 data=__dac__)
  
enddefine

**------------------------------------------------
** ATB
**------------------------------------------------

define ATB_DSI_I_TRIM_RX1(__block__=0)
  
  `comment(TM ATB_DSI_I_TRIM_RX1 __block__)
  
    `set_bitfield(name=TMR_ANA_DSI3_RX_I_TRIM_RX1 val=1)
  `jtag_write_testreg(name=TMR_ANA_DSI3_RX block=__block__)
  
enddefine

**----------

define ATB_DSI_I_TRIM_RX2(__block__=0)
  
  `comment(TM ATB_DSI_I_TRIM_RX2 __block__)
  
    `set_bitfield(name=TMR_ANA_DSI3_RX_I_TRIM_RX2 val=1)
  `jtag_write_testreg(name=TMR_ANA_DSI3_RX block=__block__)
  
enddefine

**----------

define ATB_DSI_IDAC_TX(__block__=0 __dac__=0)
  
  `comment(TM ATB_DSI_IDAC_TX __block__)
  
    `set_bitfield(name=TMR_ANA_DSI3_TX_IDAC_TX_CH1_2 val=1)
  `jtag_write_testreg(name=TMR_ANA_DSI3_TX block=__block__)

  `TM_DSI_TX_PIN
  `TRIM_DSI_TX_DAC(dac=__dac__)
  
enddefine

**----------

define ATB_DSI_VBN5V_DIV(__block__=0)
  
  `comment(TM ATB_DSI_VBN5V_DIV __block__)
  
    `set_bitfield(name=TMR_ANA_DSI3_TX_VBN5V_DIV_CH1_2 val=1)
  `jtag_write_testreg(name=TMR_ANA_DSI3_TX block=__block__)
  
enddefine

**----------

define ATB_DSI_INP(__block__=0)
  
  `comment(TM ATB_DSI_INP __block__)
  
    `set_bitfield(name=TMR_ANA_DSI3_TX_INP_CH1_2 val=1)
  `jtag_write_testreg(name=TMR_ANA_DSI3_TX block=__block__)
  
enddefine

**----------

define ATB_DSI_INN(__block__=0)
  
  `comment(TM ATB_DSI_INN __block__)
  
    `set_bitfield(name=TMR_ANA_DSI3_TX_INN_CH1_2 val=1)
  `jtag_write_testreg(name=TMR_ANA_DSI3_TX block=__block__)
  
enddefine

**----------

define ATB_DSI_VNG0(__block__=0)
  
  `comment(TM ATB_DSI_VNG0 __block__)
  
    `set_bitfield(name=TMR_ANA_DSI3_TX_VNG0_CH1_2 val=1)
  `jtag_write_testreg(name=TMR_ANA_DSI3_TX block=__block__)
  
enddefine

**----------

define ATB_DSI_VNC0(__block__=0)
  
  `comment(TM ATB_DSI_VNG1 __block__)
  
    `set_bitfield(name=TMR_ANA_DSI3_TX_VNC0_CH1_2 val=1)
  `jtag_write_testreg(name=TMR_ANA_DSI3_TX block=__block__)
  
enddefine

**----------

define ATB_DSI_VNC2(__block__=0)
  
  `comment(TM ATB_DSI_VNG2 __block__)
  
    `set_bitfield(name=TMR_ANA_DSI3_TX_VNC2_CH1_2 val=1)
  `jtag_write_testreg(name=TMR_ANA_DSI3_TX block=__block__)
  
enddefine

**------------------------------------------------
**------------------------------------------------
