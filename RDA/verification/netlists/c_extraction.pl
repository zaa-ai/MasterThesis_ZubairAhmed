#!/usr/bin/perl -w

##------------------------------------------------
## Header
##------------------------------------------------

use strict;
use Cwd;

##------------------------------------------------
## Read Input File
##------------------------------------------------

open(IN,  "$ARGV[0]")   || die "Cannot open  \"$ARGV[0]\": $!\n";
open(OUT, ">$ARGV[1]")  || die "Cannot write \"$ARGV[1]\": $!\n";

##---------

our @input;

foreach (<IN>){
  push @input, $_;
}

##------------------------------------------------
## Browse Parasitic Capacitors
##------------------------------------------------

foreach (@input){

  if ($_ =~ /^(c\S+)\s+(\S+)\s+(\S+)\s+(\S+)/i){
    my $name = $1;
    my $p    = $2;
    my $n    = $3;
    my $val  = $4;
    
    $p   =~ s/\|/\./g;
    $n   =~ s/\|/\./g;
    $val =~ s/c\=//;
    if ($p !~ /^0$/){$p = "xdut.$p"; }
    if ($n !~ /^0$/){$n = "xdut.$n";}
    
    $p =~ s/\.xx/\.x/gi;
    $n =~ s/\.xx/\.x/gi;
    $p =~ s/_([0-9]+)_/<$1>/gi;
    $n =~ s/_([0-9]+)_/<$1>/gi;
    
    my $temp = "$name $p $n c=$val";
    if ($temp !~ /\.xdigital\./ &&
        $val > 1e-15){
      print OUT "$temp\n";
    }
  }
 
}

##------------------------------------------------
## Post 
##------------------------------------------------

print OUT "\n";
print "... done\n";

##---------

close IN;
close OUT;

##------------------------------------------------
##------------------------------------------------
